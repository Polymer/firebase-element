<!--
    @license
    Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
    This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
    The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
    The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
    Code distributed by Google as part of the polymer project is also
    subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<!doctype html>
<html>
<head>

  <title>firebase-element</title>

  <script src="../../webcomponentsjs/webcomponents.js"></script>

  <link rel="import" href="../firebase-element.html">

</head>
<body unresolved>

  <template is="auto-binding">
    <!-- <firebase-element id="actions" on-data-change="{{actionDataChange}}" data="{{actionsData}}" keys="{{actionsKeys}}"  location="https://actionplanr-dev.firebaseio.com/sections2/2/doc_sections/0/doc_actions" log></firebase-element> -->

    <firebase-element id="base" on-data-change="{{dataChange}}" data="{{data}}" location="https://treedata-demo.firebaseio.com/demo"></firebase-element>

    <firebase-element id="dinosaur" on-data-change="{{dinosaurDataChange}}" data="{{dinosaurData}}" keys="{{dinosaurKeys}}"  location="https://dinosaur-facts.firebaseio.com/"></firebase-element>
    <firebase-element id="dinosaurOrderByChild" on-data-change="{{dinosaurOrderByChildDataChange}}" data="{{dinosaurOrderByChildData}}" keys="{{dinosaurOrderByChildKeys}}" orderByChild="order" location="https://dinosaur-facts.firebaseio.com/" log></firebase-element>
    <firebase-element id="dinosaurLimitFirst" data="{{dinosaurLimitFirstData}}" keys="{{dinosaurLimitFirstKeys}}" limitToFirst="2" location="https://dinosaur-facts.firebaseio.com/"></firebase-element>
    <firebase-element id="dinosaurLimitLast" data="{{dinosaurLimitLastData}}" keys="{{dinosaurLimitLastKeys}}" limitToLast="3" location="https://dinosaur-facts.firebaseio.com/"></firebase-element>
    <firebase-element id="dinosaurStartEndAt" on-data-change="{{dinosaurStartEndAtDataChange}}" data="{{dinosaurStartEndAtData}}" keys="{{dinosaurStartEndAtKeys}}"  orderByKey="true" start="b"   location="https://dinosaur-facts.firebaseio.com/"></firebase-element>

    <h3>Top-level properties persist automatically:</h3>

    <input value="{{data.name}}">
    <br>
    <input value="{{data.info}}">

    <hr>

    <h3>Nested properties must be persisted manually:</h3>

    <input value="{{data.more.color}}">

    <button on-tap="{{commitMore}}">Commit data.more</button>

    <hr>

    <h3>Remote Data</h3>
    <pre>{{json}}</pre>

    <hr>

    <button on-tap="{{resetLocal}}">Reset Local</button>
    <button on-tap="{{removeLocal}}">Remove Local</button>
    <button on-tap="{{resetRemote}}">Reset remote</button>
    <button on-tap="{{removeRemote}}">Remove Remote</button>
    <br>
    <hr>

    <h2>Dinosaur Facts All (working)</h2>
    <div horizontal layout top style="font-weight: bold; padding: 5px;; text-align: right; border: 1px solid; width: 760px;">
      <div style="width: 150px; text-align: left;">Name</div>
      <div style="width: 100px;">Height</div>
      <div style="width: 100px;">Length</div>
      <div style="width: 100px;">Weight</div>
      <div style="width: 100px;">Vppeared</div>
      <div style="width: 100px;">Vanished</div>
      <div style="width: 100px;">Order</div>
    </div>
    <template repeat="{{key in dinosaurKeys }}">
      <div horizontal layout top style="padding: 5px; text-align: right; border-bottom: 1px dotted; width: 760px;">
        <div style="width: 150px; text-align: left;">{{key}}</div>
        <div style="width: 100px;">{{dinosaurData[key].height}}</div>
        <div style="width: 100px;">{{dinosaurData[key].length}}</div>
        <div style="width: 100px;">{{dinosaurData[key].weight}}</div>
        <div style="width: 100px;">{{dinosaurData[key].appeared}}</div>
        <div style="width: 100px;">{{dinosaurData[key].vanished}}</div>
        <div style="width: 100px;">{{dinosaurData[key].order}}</div>
      </div>
    </template>
    <br>

    <br>

    <h2>Dinosaur Order by Child Order (not working)</h2>
    <div horizontal layout top style="font-weight: bold; padding: 5px;; text-align: right; border: 1px solid; width: 760px;">
      <div style="width: 150px; text-align: left;">Name</div>
      <div style="width: 100px;">Height</div>
      <div style="width: 100px;">Length</div>
      <div style="width: 100px;">Weight</div>
      <div style="width: 100px;">Vppeared</div>
      <div style="width: 100px;">Vanished</div>
      <div style="width: 100px; font-weight: bold;">Order</div>
    </div>

    <template repeat="{{key in dinosaurOrderByChildKeys }}">
      <div horizontal layout top style="padding: 5px; text-align: right; border-bottom: 1px dotted; width: 760px;">
        <div style="width: 150px; text-align: left;">{{key}}</div>
        <div style="width: 100px;">{{dinosaurOrderByChildData[key].height}}</div>
        <div style="width: 100px;">{{dinosaurOrderByChildData[key].length}}</div>
        <div style="width: 100px;">{{dinosaurOrderByChildData[key].weight}}</div>
        <div style="width: 100px;">{{dinosaurOrderByChildData[key].appeared}}</div>
        <div style="width: 100px;">{{dinosaurOrderByChildData[key].vanished}}</div>
        <div style="width: 100px;">{{dinosaurOrderByChildData[key].order}}</div>
      </div>
    </template>

    <br>
    <br>

    <h2>Dinosaur Facts First 2 (working)</h2>
    <div horizontal layout top style="font-weight: bold; padding: 5px;; text-align: right; border: 1px solid; width: 760px;">
      <div style="width: 150px; text-align: left;">Name</div>
      <div style="width: 100px;">Height</div>
      <div style="width: 100px;">Length</div>
      <div style="width: 100px;">Weight</div>
      <div style="width: 100px;">Vppeared</div>
      <div style="width: 100px;">Vanished</div>
      <div style="width: 100px;">Order</div>
    </div>
    <template repeat="{{key in dinosaurLimitFirstKeys }}">
      <div horizontal layout top style="padding: 5px; text-align: right; border-bottom: 1px dotted; width: 760px;">
        <div style="width: 150px; text-align: left;">{{key}}</div>
        <div style="width: 100px;">{{dinosaurLimitFirstData[key].height}}</div>
        <div style="width: 100px;">{{dinosaurLimitFirstData[key].length}}</div>
        <div style="width: 100px;">{{dinosaurLimitFirstData[key].weight}}</div>
        <div style="width: 100px;">{{dinosaurLimitFirstData[key].appeared}}</div>
        <div style="width: 100px;">{{dinosaurLimitFirstData[key].vanished}}</div>
        <div style="width: 100px;">{{dinosaurLimitFirstData[key].order}}</div>
      </div>
    </template>
    <br>
    <br>

    <h2>Dinosaur Last First 3 (working)</h2>
    <div horizontal layout top style="font-weight: bold; padding: 5px;; text-align: right; border: 1px solid; width: 760px;">
      <div style="width: 150px; text-align: left;">Name</div>
      <div style="width: 100px;">Height</div>
      <div style="width: 100px;">Length</div>
      <div style="width: 100px;">Weight</div>
      <div style="width: 100px;">Vppeared</div>
      <div style="width: 100px;">Vanished</div>
      <div style="width: 100px;">Order</div>
    </div>
    <template repeat="{{key in dinosaurLimitLastKeys }}">
      <div horizontal layout top style="padding: 5px; text-align: right; border-bottom: 1px dotted; width: 760px;">
        <div style="width: 150px; text-align: left;">{{key}}</div>
        <div style="width: 100px;">{{dinosaurLimitLastData[key].height}}</div>
        <div style="width: 100px;">{{dinosaurLimitLastData[key].length}}</div>
        <div style="width: 100px;">{{dinosaurLimitLastData[key].weight}}</div>
        <div style="width: 100px;">{{dinosaurLimitLastData[key].appeared}}</div>
        <div style="width: 100px;">{{dinosaurLimitLastData[key].vanished}}</div>
        <div style="width: 100px;">{{dinosaurLimitLastData[key].order}}</div>
      </div>
    </template>
    <br>
    <br>

    <h2>Dinosaur Starting with B  (not working)</h2>
    <div horizontal layout top style="font-weight: bold; padding: 5px;; text-align: right; border: 1px solid; width: 760px;">
      <div style="width: 150px; text-align: left;">Name</div>
      <div style="width: 100px;">Height</div>
      <div style="width: 100px;">Length</div>
      <div style="width: 100px;">Weight</div>
      <div style="width: 100px;">Vppeared</div>
      <div style="width: 100px;">Vanished</div>
      <div style="width: 100px;">Order</div>
    </div>
    <template repeat="{{key in dinosaurStartEndAtKeys }}">
      <div horizontal layout top style="padding: 5px; text-align: right; border-bottom: 1px dotted; width: 760px;">
        <div style="width: 150px; text-align: left;">{{key}}</div>
        <div style="width: 100px;">{{dinosaurStartEndAtData[key].height}}</div>
        <div style="width: 100px;">{{dinosaurStartEndAtData[key].length}}</div>
        <div style="width: 100px;">{{dinosaurStartEndAtData[key].weight}}</div>
        <div style="width: 100px;">{{dinosaurStartEndAtData[key].appeared}}</div>
        <div style="width: 100px;">{{dinosaurStartEndAtData[key].vanished}}</div>
        <div style="width: 100px;">{{dinosaurStartEndAtData[key].order}}</div>
      </div>
    </template>
    <br>
    <br>


    <hr>
    <br>

    <button on-tap="{{loopData}}">Loop Data</button>
    <br>
    <br>

  </template>

  <script>

    addEventListener('polymer-ready', function(e) {
      console.log('polymer-ready');
    });

    addEventListener('template-bound', function(e) {
      console.log('template-bound');
      scope = e.target;


      scope.resetLocal = function() {
        // direct setting of data is persisted automatically
        this.data = {
          name: 'anonymous',
          info: 'none',
          more: {
            color: "yellow"
          }
        };
      };

      scope.removeLocal = function() {
        this.data = null;
      };

      scope.resetRemote = function() {
        // Simulate other actor setting data to same remote location
        new Firebase('https://treedata-demo.firebaseio.com/demo').set({
          name: 'anonymous',
          info: 'none',
          more: {
            color: "yellow"
          }
        });
      };

      scope.removeRemote = function() {
        // Simulate other actor removing data from same remote location
        new Firebase('https://treedata-demo.firebaseio.com/demo').remove();
      };

      scope.commitMore = function() {
        this.$.base.commitProperty('more');
      };

      scope.dataChange = function() {
        this.json = JSON.stringify(this.data, null, '\t');
      };

      scope.dinosaurDataChange = function() {
        // console.log("dinosaurDataChange");
      };

      scope.dinosaurOrderByChildDataChange = function() {
        console.log("dinosaurOrderByChildDataChange", this.dinosaurOrderByChildData );
      };

      scope.dinosaurStartEndAtDataChange = function() {
        // console.log("dinosaurStartEndAtDataChange", this.dinosaurStartEndAtData );
      };

      scope.loopData = function() {
        var keys = this.$.dinosaurOrderByChild.keys;
        var keysLen = keys.length;
        console.log("loopData: dinosaurOrderByChildData", keysLen, keys );

          for(var i=0; i < keysLen; i++) {
            curKey = keys[i];
            // curId = this.dinosaurStartEndAtData[keys[i]].id;
            // count++;
            var dataContent = this.dinosaurOrderByChildData[keys[i]];
            console.log(i+1,curKey, dataContent.order, dataContent.height, dataContent.length);
          }
          console.log("dinosaurOrderByChildKeys keysLen: ", keysLen, "dinosaurs: ", typeof(this.dinosaurOrderByChildData),this.dinosaurOrderByChildData);

      };

    });
  </script>

</body>
</html>
